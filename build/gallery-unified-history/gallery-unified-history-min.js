YUI.add("gallery-unified-history",function(a){var c="popstate",g=a.Do,f=a.Lang,h=a.config.win,m=h.location,i=a.HistoryHash,k=a.HistoryHTML5,e=k.prototype._init,l=i.prototype._init,d=i.parseHash,b=i.createHash;function j(o,n){if(n.useKeyValuePair){return(m.href.indexOf("?")!=-1?"&":"?")+b(o);}else{if(n.usePath){return(m.href.charAt(m.href.length-1)==="/"?"":"/")+i._createPath(o,n.usePath);}}}k._updateUrl=function(p,o,n){if(p!==c){n.url=m.href+j(o,this._config);}};k.prototype._init=function(){g.before(k._updateUrl,this,"_storeState",this);e.apply(this,arguments);};i.prototype._init=function(n){g.before(i._injectInstance,i,"parseHash",this);g.after(i._ejectInstance,i,"parseHash",this);g.before(i._injectInstance,i,"createHash",this);g.after(i._ejectInstance,i,"createHash",this);l.apply(this,arguments);};i._injectInstance=function(){i._currInstance=this;};i._ejectInstance=function(n){delete i._currInstance;};i.parseHash=function(o){var n=i._currInstance&&i._currInstance._config&&i._currInstance._config.usePath;if(!n){d.apply(this,arguments);return;}else{return i._parsePath(o,n);}};i._parsePath=function(q,v){var n=i.decode,r,u,s,o,p={},t=i.hashPrefix,w;q=f.isValue(q)?q:i.getHash();if(t){w=q.indexOf(t);if(w===0||(w===1&&q.charAt(0)==="#")){q=q.replace(t,"");}}s=q.split("/");for(r=0,u=s.length;r<u;++r){p[n(v[r])]=n(s[r]);}return p;};i.createHash=function(o){var n=i._currInstance&&i._currInstance._config&&i._currInstance._config.usePath;if(!n){b.apply(this,arguments);return;}else{return i._createPath(o,n);}};i._createPath=function(p,q){var o=i.encode,n=[];a.Array.each(q,function(s,r){if(f.isValue(p[s])){n.push(p[s]);}});return n.join("/");};},"@VERSION@",{skinnable:false,requires:["history"]});